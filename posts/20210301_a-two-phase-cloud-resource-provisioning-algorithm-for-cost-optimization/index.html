<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>A two-phase cloud resource provisioning algorithm for cost optimization - 实践出真知</title><meta name="Description" content="后端技术博客"><meta property="og:title" content="A two-phase cloud resource provisioning algorithm for cost optimization" />
<meta property="og:description" content="A two-phase cloud resource provisioning algorithm for cost optimization 1 Introduction 主要的三种付费方式： On-demand pricing model Reserved pricing model spot pricing model 现有的模型大多都只考虑了on-demand的收费方式，有一些考虑了on-dema" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://wtysos11.github.io/posts/20210301_a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-03-01T19:49:04+08:00" />
<meta property="article:modified_time" content="2021-03-01T19:49:04+08:00" /><meta property="og:site_name" content="实践出真知" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="A two-phase cloud resource provisioning algorithm for cost optimization"/>
<meta name="twitter:description" content="A two-phase cloud resource provisioning algorithm for cost optimization 1 Introduction 主要的三种付费方式： On-demand pricing model Reserved pricing model spot pricing model 现有的模型大多都只考虑了on-demand的收费方式，有一些考虑了on-dema"/>
<meta name="application-name" content="实践出真知">
<meta name="apple-mobile-web-app-title" content="实践出真知"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://wtysos11.github.io/posts/20210301_a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization/" /><link rel="prev" href="http://wtysos11.github.io/posts/20210301_business-driven-long-term-capacity-planning-for-saas-applications/" /><link rel="next" href="http://wtysos11.github.io/posts/20210303_java%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF%E5%8D%B7i%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "A two-phase cloud resource provisioning algorithm for cost optimization",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/wtysos11.github.io\/posts\/20210301_a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization\/"
        },"genre": "posts","keywords": "云资源调度","wordcount":  1890 ,
        "url": "http:\/\/wtysos11.github.io\/posts\/20210301_a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization\/","datePublished": "2021-03-01T19:49:04+08:00","dateModified": "2021-03-01T19:49:04+08:00","publisher": {
            "@type": "Organization",
            "name": "Carlo Wu"},"author": {
                "@type": "Person",
                "name": "Carlo Wu"
            },"description": ""
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="实践出真知">实践出真知</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="选择语言">简体中文<i class="fas fa-chevron-right fa-fw"></i>
                        <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/posts/20210301_a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization/" selected>简体中文</option></select>
                    </a><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="实践出真知">实践出真知</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="选择语言">简体中文<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/posts/20210301_a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization/" selected>简体中文</option></select>
                </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">A two-phase cloud resource provisioning algorithm for cost optimization</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/wtysos11/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>Carlo Wu</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/"><i class="far fa-folder fa-fw"></i>计算机论文阅读</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-03-01">2021-03-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 1890 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 4 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#1-introduction">1 Introduction</a></li>
    <li><a href="#2-related-work">2 related work</a></li>
    <li><a href="#3-problem-formulation">3 Problem Formulation</a>
      <ul>
        <li><a href="#31-云环境">3.1 云环境</a></li>
        <li><a href="#32-cloud-resource-provisioning-problem">3.2 Cloud Resource Provisioning Problem</a></li>
      </ul>
    </li>
    <li><a href="#4-resource-reservation">4 Resource Reservation</a>
      <ul>
        <li><a href="#41-sample-average-approximationsaa">4.1 Sample Average Approximation(SAA)</a></li>
        <li><a href="#42-dual-decomposition-based-branch-and-bound-ddbnb">4.2 Dual Decomposition-Based Branch and Bound (DDBnB)</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization">A two-phase cloud resource provisioning algorithm for cost optimization</h1>
<h2 id="1-introduction">1 Introduction</h2>
<p>主要的三种付费方式：</p>
<ul>
<li>On-demand pricing model</li>
<li>Reserved pricing model</li>
<li>spot pricing model</li>
</ul>
<p>现有的模型大多都只考虑了on-demand的收费方式，有一些考虑了on-demand和reserved的收费方式。但是它们的目标都只是使用reserved收费的资源来满足最低服务需求，并用on-demand的资源来满足剩余需求。</p>
<p>本文的目标是找到最佳的实例数，即resource provisioning problem。为了降低资源的租用成本，本文使用了on-demand和reserved instance两种方式来进行一个两阶段的资源分配，并决定最佳的reserved instance的实例数来最小化花费。为此，需要基于预测的流量信息来满足SLA的要求。</p>
<p>主要贡献：</p>
<ol>
<li>使用on-demand和reserved instance的两阶段资源部署算法来减少资源租用花费</li>
<li>在第一阶段，将资源配置问题建模为two-stage stochastic programming problem，并用sample average approximation的方式和dual decomposition method的方式来求解</li>
<li>在第二阶段，使用ARIMA-Kalman model来预测流量，并决定on-demand的实例数量。</li>
<li>使用现实世界的流量和Amazon EC2购买模型来验证结果。</li>
</ol>
<h2 id="2-related-work">2 related work</h2>
<p>主要提到了云资源分配问题可以被建模为stochastic programming problem，然后使用branch and bound and cutting plane method求解，或者使用启发式方法，比如genetic algorithm, particle swarm optimization, hybrid algorithm等。一般使用PSO来探索解空间，使用GA来更新结果。</p>
<h2 id="3-problem-formulation">3 Problem Formulation</h2>
<p>本节主要内容为模型的假设，包括VM的配置与价格模型。基于这些假设，我们可以对云资源分配问题进行建模。</p>
<h3 id="31-云环境">3.1 云环境</h3>
<p>云资源提供商提供多种不同的VM给用户，$V={V_1,&hellip;,V_M}$代表了不同种类的虚拟机，M为虚拟机的种类。每一个VM的种类有着自己的资源配置和处理容量。令$C_i$表示$V_i$类虚拟机在不违反QoS的情况下所能处理的最大并发用户数或者最大服务请求速率。</p>
<p>我们采用小时计费的方式，并考虑两种不同的模型：on-demand实例和instance实例。令$p_i^o$表示类型$V_i$的on-demand费用，令$p_i^R$与$p_i^r$分别代表reserved instance的总支付费用与每小时费用。令$T$代表reserved instance的使用时间。这样，虚拟机类型$V_i$的实际成本为$p_i^R/T+p_i^r$，即平均每小时的总费用加上每小时的实际费用。一般来说，reserved instance的每小时费用都要低于on-demand的付费。</p>
<h3 id="32-cloud-resource-provisioning-problem">3.2 Cloud Resource Provisioning Problem</h3>
<p>在一个reservation period中考虑这个cloud resource provision problem，令t=1,2,&hellip;,T为该reservation period中的hour index，令$d_t$为时间t时的workload，$R=(n_1^r,n_2^r,&hellip;,n_M^r)$表示reservation decision，其中$n_i^r$为$V_i$类虚拟机的数量。这样，就可以计算出reserved实例的processing capacity $\sum_{i=1}^{M}n_i^r C_i$，以及总费用。</p>
<p>对于每一个时间点t，如果reserved instance能够满足需求，显然也没有再购买on-demand资源的必要</p>
<p>因此，on demand的使用费用可以写为$U(R,d_t) = min \sum_{i-1}^M n_{ti}^o p)i^o$，其中$n_{ti}^o$就是类型$V_i$在时间t所使用的on-demand的实例数</p>
<p>此时，resource reservation problem可以建模为最小化reserved instance费用与on-demand instance的费用。显然这个问题是依赖于reservation阶段的流量的，这个在现在来说是不知道的，但我们可以基于历史数据来预测流量的分布情况$p_D(d)$。</p>
<h2 id="4-resource-reservation">4 Resource Reservation</h2>
<h3 id="41-sample-average-approximationsaa">4.1 Sample Average Approximation(SAA)</h3>
<p>如果scenarios的数量比较大的话，直接求解前面的最优化式子是非常困难的。sample average approximation就是用来减少scenarios数量的方法。考虑到workload是一个一维的随机变量，就可以使用uniform discretization grid来产生一个scenarios的集合${\tilde{d_1},\tilde{d_2},&hellip;,\tilde{d_N}}$，其中$N$是采样大小。用采样结果来拟合复杂的概率结果，化简two-stage stochastic problem。</p>
<h3 id="42-dual-decomposition-based-branch-and-bound-ddbnb">4.2 Dual Decomposition-Based Branch and Bound (DDBnB)</h3>
<p>scenario decomposition是引入copy $R_j$作为每个scenario中第一阶段决策动作$R$，然后重新建模原问题。</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2021-03-01</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="http://wtysos11.github.io/posts/20210301_a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization/" data-title="A two-phase cloud resource provisioning algorithm for cost optimization" data-hashtags="云资源调度"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="http://wtysos11.github.io/posts/20210301_a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization/" data-hashtag="云资源调度"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="分享到 WhatsApp" data-sharer="whatsapp" data-url="http://wtysos11.github.io/posts/20210301_a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization/" data-title="A two-phase cloud resource provisioning algorithm for cost optimization" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="http://wtysos11.github.io/posts/20210301_a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization/" data-title="A two-phase cloud resource provisioning algorithm for cost optimization"><i data-svg-src="/lib/simple-icons/icons/line.min.svg"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="http://wtysos11.github.io/posts/20210301_a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization/" data-title="A two-phase cloud resource provisioning algorithm for cost optimization"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Myspace" data-sharer="myspace" data-url="http://wtysos11.github.io/posts/20210301_a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization/" data-title="A two-phase cloud resource provisioning algorithm for cost optimization" data-description=""><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg"></i></a><a href="javascript:void(0);" title="分享到 Blogger" data-sharer="blogger" data-url="http://wtysos11.github.io/posts/20210301_a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization/" data-title="A two-phase cloud resource provisioning algorithm for cost optimization" data-description=""><i class="fab fa-blogger fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Evernote" data-sharer="evernote" data-url="http://wtysos11.github.io/posts/20210301_a-two-phase-cloud-resource-provisioning-algorithm-for-cost-optimization/" data-title="A two-phase cloud resource provisioning algorithm for cost optimization"><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/%E4%BA%91%E8%B5%84%E6%BA%90%E8%B0%83%E5%BA%A6/">云资源调度</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/20210301_business-driven-long-term-capacity-planning-for-saas-applications/" class="prev" rel="prev" title="Business-Driven Long-Term Capacity Planning for SaaS Applications"><i class="fas fa-angle-left fa-fw"></i>Business-Driven Long-Term Capacity Planning for SaaS Applications</a>
            <a href="/posts/20210303_java%E6%A0%B8%E5%BF%83%E6%8A%80%E6%9C%AF%E5%8D%B7i%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" class="next" rel="next" title="《Java核心技术 卷I：基础知识》读书笔记">《Java核心技术 卷I：基础知识》读书笔记<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.87.0">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/wtysos11/" target="_blank">Carlo Wu</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/algoliasearch/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":30},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"algoliaAppID":"46GYFZ8M81","algoliaIndex":"myblog","algoliaSearchKey":"10948d6f4e69e7991b7a4f9cb5095f13","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
